# SQL Sorgu Alıştırmaları

Bu hafta SQL sorguları üzerine çalışıyorsunuz. Bugünkü alıştırmada sıfırdan bir veritabanı oluşturacak ve aşağıda istenenleri SQL sorgu olarak oluşturacaksınız.

# Proje Kurulumu

Projeyi forklayın ve clonlayın. Tamamladığınızda da pushlayın.

## Görev 1: Kütüphane Bilgi Sistemi için Tablo Tasarımı

Bu veritabanı, bir okulun kütüphanesinden öğrencilerin aldıkları kitapların bilgisini barındıracak.
Aşağıda tablolar ve şemaları verilmiş.

[ ] Bu tabloların tasarımını online olarak veya bilgisayarınızda bir yazılım kullanarak dizayn ediniz. (örn: [drawsql.app](https://drawsql.app/)
[ ] Resim olarak proje dosyasına ekleyiniz.

-- Tablolar

`ogrenci` tablosu öğrencilerin listesini tutar.

| field    | data type        | metadata                                      |
| :------- | :--------------- | :-------------------------------------------- |
| id       | unsigned integer | primary key, auto-increments, generated by db |
| ad       | string           | required                                      |
| soyad    | string           | required                                      |
| dtarih   | string           | required                                      |
| cinsiyet | string           | required                                      |
| sinif    | string           | required                                      |
| puan     | unsigned integer | required                                      |

`islem` tablosu öğrencilerin kütüphaneden aldıkları kitapların bilgilerini tutar

| field      | data type        | metadata                                      |
| :--------- | :--------------- | :-------------------------------------------- |
| id         | unsigned integer | primary key, auto-increments, generated by db |
| ogrenci_id | unsigned integer | foreign key referencing ogrenci.id, required  |
| kitap_id   | unsigned integer | foreign key referencing kitap.id, required    |
| atarih     | string           | required                                      |
| vtarih     | string           | required                                      |

`kitap` tablosu kütüphanedeki kitapların bilgisini tutar

| field       | data type        | metadata                                      |
| :---------- | :--------------- | :-------------------------------------------- |
| id          | unsigned integer | primary key, auto-increments, generated by db |
| ad          | string           | required                                      |
| sayfasayisi | unsigned integer | required                                      |
| puan        | unsigned integer | required                                      |
| yazar_id    | unsigned integer | foreign key referencing yazar.id, required    |
| tur_id      | unsigned integer | foreign key referencing tur.id, required      |

`yazar` tablosu kitapların yazarları bilgisini tutar

| field | data type        | metadata                                      |
| :---- | :--------------- | :-------------------------------------------- |
| id    | unsigned integer | primary key, auto-increments, generated by db |
| ad    | string           | required                                      |
| soyad | string           | required                                      |

`tur` tablosu kitapların türlerini tutar.

| field | data type        | metadata                                      |
| :---- | :--------------- | :-------------------------------------------- |
| id    | unsigned integer | primary key, auto-increments, generated by db |
| ad    | string           | required                                      |

### Görev 2: SQL İfadeleri

[ ] Görev 1'de tasarımını yaptığınız tabloları DB'de oluşturan komutları kutuphane_bilgi_sistemi.sql dosyasında oluşturunuz.

#### Görev 3:

[ ] veriler.sql içindeki hataları düzelterek, verileri veritabanınıza ekleyiniz.

##### Görev 4:

[ ] Aşağıda istenen değişiklikleri tablolarda yapacak SQL ifadeleri yazınız.

1- öğrenci tablosuna 'sehir' alanı ekleyiniz.
ALTER TABLE ogrenci
ADD COLUMN sehir VARCHAR(255);

2- tablolarda veri olarak tarih geçen alanlarda veri tipini string yerine DateTime olarak ayarlayınız.
DO $$DECLARE
r RECORD;
BEGIN

    EXECUTE 'ALTER TABLE ogrenci ALTER COLUMN dtarih TYPE DATETIME USING dtarih::timestamp::text::datetime';

    EXECUTE 'ALTER TABLE islem ALTER COLUMN atarih TYPE DATETIME USING atarih::timestamp::text::datetime';

    EXECUTE 'ALTER TABLE islem ALTER COLUMN vtarih TYPE DATETIME USING vtarih::timestamp::text::datetime';
      END$$;

3- öğrenci tablosuna 'dogum_yeri' alanı ekleyiniz ve default değerini 'Türkiye' yapınız.
ALTER TABLE ogrenci
ADD COLUMN dogum_yeri VARCHAR(255) DEFAULT 'Türkiye';

4- öğrenci tablosundan 'puan' alanını siliniz.
ALTER TABLE ogrenci
DROP COLUMN puan;

5- öğrenciler tablosundaki kiz öğrencileri alarak kiz_ogrenciler tablosu oluşturunuz.
CREATE TABLE kiz_ogrenciler AS
SELECT \*
FROM ogrenci
WHERE cinsiyet = 'K';

6- kiz_ogrenciler tablosunu siliniz.
DROP TABLE IF EXISTS kiz_ogrenciler;

7- kiz_yurdu tablosu oluşturunuz(sadece 'ad' alanı olsun). 1 kayıt ekleyiniz.
öğrenci tablosundaki kız öğrencileri kullanarak kiz_yurdunda_kalanlar tablosu oluşturunuz
a)
CREATE TABLE kiz_yurdu (
ad VARCHAR(255));

INSERT INTO kiz_yurdu (ad)
VALUES ('Emine');

b)
CREATE TABLE kiz_yurdunda_kalanlar AS
SELECT \*
FROM ogrenci
WHERE cinsiyet = 'K';

8- kiz_ogrenciler tablosunun adını kogrenciler olarak değiştiriniz
ALTER TABLE kiz_ogrenciler
RENAME TO kogrenciler;

9- yazar tablosundaki 'ad' alanının adını 'name' olarak güncelleyiniz.
ALTER TABLE yazar
RENAME COLUMN ad TO name;

10- yazar tablosuna 'ulke' ve 'universite' alanları ekleyiniz 'ulke'nin default değeri 'Türkiye' olsun.
ALTER TABLE yazar
ADD COLUMN ulke VARCHAR(255) DEFAULT 'Türkiye',
ADD COLUMN universite VARCHAR(255);

11- tablo ilişkilerine 5'er tane örnek veriniz (1-1, 1-n, n-n)

ONE-TO-ONE

1. Pasaport ile Pasaport sahibi
2. Vatandaşlık No ile vatandaş
3. Web sitesi kullanıcı hesabı ile kullanıcının kayıtlı email adresi
4. İnsan ve parmak izi
5. Araç ruhsatı ve araç

ONE-TO-MANY

1. Müşteri ve siparişleri
2. Öğrenci ve okul
3. Yazar ve kitapları
4. Ülke ve şehirler
5. Kıta ve ülkeler

MANY-TO-MANY

1. Oyuncular ve filmler
2. Öğrenciler ve dersler
3. Ürünler ve siparişler
4. Çalışanlar ve görev alınan projeler
5. Müzisyenler ve çaldıkları müzik grupları
